<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>The Trade Intelligence</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  background:#0b0f18;
  color:white;
  font-family:Segoe UI;
  margin:0;
}
.header{
  text-align:center;
  padding:16px;
  font-size:26px;
  font-weight:900;
  background:#111a33;
}

.grid{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:16px;
  padding:16px;
}

.card{
  background:#16214d;
  border-radius:14px;
  padding:12px;
  height:230px;
  cursor:pointer;
}

.card.red{
  background:linear-gradient(145deg,#5b1111,#2a0505);
}

.instrument{font-size:18px;font-weight:800;text-align:center;}
.row{text-align:center;font-size:12px;margin-top:3px;}
.action{text-align:center;font-size:26px;font-weight:900;margin-top:8px;}
.subtext{text-align:center;font-size:14px;margin-top:6px;font-weight:700;}

.buy{color:#00ff9c}
.sell{color:#ff5c5c}
.warn{
  color:#ffd000;
  background:black;
  padding:4px 8px;
  border-radius:6px;
  font-weight:900;
  font-size:22px;
  display:inline-block;
}

.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  justify-content:center;
  align-items:center;
}

.modal{
  background:#111a33;
  padding:16px;
  border-radius:12px;
  width:420px;
}

.section{margin-top:8px;}
.section b{font-size:12px;}

.separator{
  border-top:1px solid #444;
  margin:10px 0;
}

.pill{
  display:inline-block;
  padding:6px 10px;
  margin:4px;
  border:1px solid #777;
  border-radius:10px;
  font-size:12px;
  cursor:pointer;
}
.pill.active{
  background:white;
  color:black;
  font-weight:800;
}

button{
  width:100%;
  margin-top:10px;
  padding:8px;
}
</style>
</head>

<body>

<div class="header">THE TRADE INTELLIGENCE</div>
<div class="grid" id="board"></div>

<div class="overlay" id="overlay">
<div class="modal">
<h2 id="title"></h2>

<div class="section">
<b>Trend</b><br>
<span class="pill" onclick="toggle('trend','Bullish')">Bullish</span>
<span class="pill" onclick="toggle('trend','Bearish')">Bearish</span>
</div>

<div class="separator"></div>

<div class="section">
<span class="pill" onclick="toggle('clean',true)">Clean</span>
</div>

<div class="separator"></div>

<div class="section">
<b>Parallel Channel Proper</b><br>
<span class="pill" onclick="toggle('pc','Bullish')">Bullish Parallel Channel Proper</span>
<span class="pill" onclick="toggle('pc','Bearish')">Bearish Parallel Channel Proper</span>
</div>

<div class="section">
<b>Double Top / Bottom</b><br>
<span class="pill" onclick="toggle('dt','Proper')">Proper</span>
<span class="pill" onclick="toggle('dt','Deep')">Deep Pullback</span>
</div>

<div class="section">
<b>Consolidation</b><br>
<span class="pill" onclick="toggle('con','<1.5RR')">&lt;1.5RR</span>
<span class="pill" onclick="toggle('con','2RR')">2RR</span>
<span class="pill" onclick="toggle('con','Neckline')">At Neckline</span>
</div>

<div class="section">
<b>Inside Candle</b><br>
<span class="pill" onclick="toggle('inside','Clean Neckline')">Clean Neckline</span>
<span class="pill" onclick="toggle('inside','Submerged')">Submerged</span>
</div>

<div class="section">
<b>Traps</b><br>
<span class="pill" onclick="toggle('liq',true)">Liquidity Trap</span>
<span class="pill" onclick="toggle('pct',true)">PCT</span>
</div>

<div class="section">
<b>SMMA</b><br>
<span class="pill" onclick="toggle('smma',true)">Accumulation at SMMA</span>
</div>

<button onclick="closeModal()">Close</button>
</div>
</div>

<script>
const instruments=[
"EURUSD","GBPUSD","EURGBP","USDJPY",
"GBPJPY","AUDUSD","USDCAD","NZDUSD",
"SP500","UK100","NAS100","XAUUSD","BTCUSD"
];

const board=document.getElementById("board");
const overlay=document.getElementById("overlay");
const title=document.getElementById("title");

let active=null;
let state={};

instruments.forEach(i=>{
  state[i]={
    trend:null,
    clean:false,
    pc:null,
    dt:null,
    con:null,
    inside:null,
    liq:false,
    pct:false,
    smma:false
  };
  const c=document.createElement("div");
  c.className="card";
  c.id=i;
  c.innerHTML=`
    <div class="instrument">${i}</div>
    <div class="row" id="${i}_trend">Trend: —</div>
    <div class="row" id="${i}_cat">Category: —</div>
    <div class="action">—</div>
    <div class="subtext"></div>
  `;
  c.onclick=()=>openModal(i);
  board.appendChild(c);
});

function openModal(n){
  active=n;
  title.innerText=n;
  overlay.style.display="flex";
  refreshModal();
}
function closeModal(){ overlay.style.display="none"; }

function toggle(key,val){
  if(typeof state[active][key]==="boolean"){
    state[active][key]=!state[active][key];
  }else{
    state[active][key]=state[active][key]===val?null:val;
  }
  update(active);
  refreshModal();
}

function refreshModal(){
  document.querySelectorAll(".pill").forEach(p=>p.classList.remove("active"));
  const s=state[active];
  document.querySelectorAll(".pill").forEach(p=>{
    const t=p.innerText;
    if(t==="Bullish" && s.trend==="Bullish")p.classList.add("active");
    if(t==="Bearish" && s.trend==="Bearish")p.classList.add("active");
    if(t==="Clean" && s.clean)p.classList.add("active");
    if(t.includes("Bullish Parallel") && s.pc==="Bullish")p.classList.add("active");
    if(t.includes("Bearish Parallel") && s.pc==="Bearish")p.classList.add("active");
    if(t==="Proper" && s.dt==="Proper")p.classList.add("active");
    if(t==="Deep Pullback" && s.dt==="Deep")p.classList.add("active");
    if(t==="<1.5RR" && s.con==="<1.5RR")p.classList.add("active");
    if(t==="2RR" && s.con==="2RR")p.classList.add("active");
    if(t==="At Neckline" && s.con==="Neckline")p.classList.add("active");
    if(t==="Clean Neckline" && s.inside==="Clean Neckline")p.classList.add("active");
    if(t==="Submerged" && s.inside==="Submerged")p.classList.add("active");
    if(t==="Liquidity Trap" && s.liq)p.classList.add("active");
    if(t==="PCT" && s.pct)p.classList.add("active");
    if(t==="Accumulation at SMMA" && s.smma)p.classList.add("active");
  });
}

function update(n){
  const s=state[n];
  const card = document.getElementById(n);

  // reset card color
  card.className = "card";
  document.getElementById(n+"_trend").innerText="Trend: "+(s.trend||"—");

  let categories=[];
  if(s.clean) categories.push("Clean");
  if(s.pc) categories.push(s.pc+" Parallel Channel Proper");
  if(s.dt) categories.push("Double Top/Bottom");
  if(s.con) categories.push("Consolidation");
  if(s.inside) categories.push(s.inside);
  if(s.liq) categories.push("Liquidity Trap");
  if(s.pct) categories.push("PCT");
  if(s.smma) categories.push("Accumulation at SMMA");

  document.getElementById(n+"_cat").innerText=
    "Category: "+(categories.length?categories.join(" & "):"—");

  let action="—";
  let sub="";

  // NO TRADE
if(
  s.pct ||
  s.smma ||
  s.inside==="Submerged" ||
  s.con==="<1.5RR" ||
  s.dt==="Proper"
){
  action="⛔ NO TRADE";
  card.classList.add("red");
}
// DEEP PULLBACK MODE
else if(s.dt==="Deep" && s.trend){
  action = s.trend==="Bullish"
    ? `<span class="buy">⬆ BUY</span>`
    : `<span class="sell">⬇ SELL</span>`;
  sub = "Deep pullback – trade with trend";
}
  // CLEAN MODE
  else if(s.clean && s.trend){
    action = s.trend==="Bullish"
      ? `<span class="buy">⬆ BUY</span>`
      : `<span class="sell">⬇ SELL</span>`;
  }
  // CAUTION ONLY
  else if(s.con==="2RR" || s.con==="Neckline" || s.liq){
    action=`<span class="warn">⚠</span>`;
    if(s.con==="2RR") sub="Only trade with 1.5 RR";
    if(s.con==="Neckline") sub="Only trade after failed breakout";
    if(s.liq) sub="Trade only after candle closes beyond wick";
  }
  // PARALLEL CHANNEL PROPER LOGIC
  else if(s.trend && s.pc){
    if(s.trend==="Bullish" && s.pc==="Bullish"){
      action=`<span class="warn">⚠</span><br><span class="buy">⬆ BUY</span>`;
      sub="Buy only near lower line";
    }
    if(s.trend==="Bearish" && s.pc==="Bearish"){
      action=`<span class="warn">⚠</span><br><span class="sell">⬇ SELL</span>`;
      sub="Sell only near upper line";
    }
    if(s.trend==="Bullish" && s.pc==="Bearish"){
      action=`<span class="buy">⬆ BUY</span>`;
      sub="Be cautious near new points";
    }
    if(s.trend==="Bearish" && s.pc==="Bullish"){
      action=`<span class="sell">⬇ SELL</span>`;
      sub="Be cautious near new points";
    }
  }

  document.querySelector("#"+n+" .action").innerHTML=action;
  document.querySelector("#"+n+" .subtext").innerText=sub;
}
</script>

</body>
</html>
